(function(v,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(v=typeof globalThis<"u"?globalThis:v||self,o(v.VueResizablePanels={},v.Vue))})(this,function(v,o){"use strict";const A=Symbol("PanelGroupContext");let ee=0;function U(e){return e||(ee++,`vue-resizable-panels:${ee}`)}const ne=o.defineComponent({__name:"Panel",props:{id:{},className:{default:""},collapsedSize:{default:0},collapsible:{type:Boolean,default:!1},defaultSize:{},maxSize:{},minSize:{},onCollapse:{},onExpand:{},onResize:{},order:{},style:{},tagName:{default:"div"}},emits:["collapse","expand","resize"],setup(e,{expose:t,emit:n}){const l=e,a=n,i=o.inject(A);if(!i)throw new Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:s,expandPanel:u,getPanelSize:d,getPanelStyle:y,groupId:m,isPanelCollapsed:S,reevaluatePanelConstraints:P,registerPanel:I,resizePanel:C,unregisterPanel:D}=i,w=U(l.id),z=o.ref({callbacks:{onCollapse:()=>a("collapse"),onExpand:()=>a("expand"),onResize:(p,x)=>a("resize",p,x)},constraints:{collapsedSize:l.collapsedSize,collapsible:l.collapsible,defaultSize:l.defaultSize,maxSize:l.maxSize,minSize:l.minSize},id:w,idIsFromProps:l.id!==void 0,order:l.order}),r=o.computed(()=>{const p=d(z.value);return console.log(`Panel ${w} size:`,p),p}),f=o.computed(()=>S(z.value)),c=o.computed(()=>{const p=y(z.value,l.defaultSize);return console.log(`Panel ${w} style:`,p),{...p,...l.style}});return o.watch(()=>({collapsedSize:l.collapsedSize,collapsible:l.collapsible,maxSize:l.maxSize,minSize:l.minSize}),(p,x)=>{const L={...z.value.constraints};z.value.constraints.collapsedSize=p.collapsedSize,z.value.constraints.collapsible=p.collapsible,z.value.constraints.maxSize=p.maxSize,z.value.constraints.minSize=p.minSize,(L.collapsedSize!==p.collapsedSize||L.collapsible!==p.collapsible||L.maxSize!==p.maxSize||L.minSize!==p.minSize)&&P(z.value,L)},{deep:!0}),I(z.value),o.onUnmounted(()=>{D(z.value)}),t({collapse:()=>s(z.value),expand:p=>u(z.value,p),getId:()=>w,getSize:()=>d(z.value),isCollapsed:()=>f.value,isExpanded:()=>!S(z.value),resize:p=>C(z.value,p)}),(p,x)=>(o.openBlock(),o.createBlock(o.resolveDynamicComponent(p.tagName),{class:o.normalizeClass(p.className),style:o.normalizeStyle(c.value),"data-panel":!0,"data-panel-id":o.unref(w),"data-panel-size":r.value,"data-panel-collapsible":p.collapsible||void 0,"data-panel-collapsed":f.value||void 0},{default:o.withCtx(()=>[o.renderSlot(p.$slots,"default")]),_:3},8,["class","style","data-panel-id","data-panel-size","data-panel-collapsible","data-panel-collapsed"]))}});function k(e,t){if(!e)throw new Error(t||"Assertion failed")}const te=5;function le(e,t,n=te){const l=parseFloat(e.toFixed(n)),a=parseFloat(t.toFixed(n));return l<a?-1:l>a?1:0}function M(e,t,n=te){return le(e,t,n)===0}function ge({panelConstraints:e,panelIndex:t,size:n}){const{collapsedSize:l=0,collapsible:a,maxSize:i=100,minSize:s=0}=e[t]??{};return a&&M(n,l)?l:n<s?s:n>i?i:n}function Y({panelConstraints:e,panelIndex:t,size:n}){return ge({panelConstraints:e,panelIndex:t,size:n})}function he({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:l,prevLayout:a,trigger:i}){if(M(e,0))return t;const s=[...t],[u,d]=l;k(u!=null,"Invalid first pivot index"),k(d!=null,"Invalid second pivot index");let y=0;{const m=t[u];k(m!=null,`Previous layout not found for panel index ${u}`);const S=m+e,P=Y({panelConstraints:n,panelIndex:u,size:S});M(m,P)||(y=P-m,s[u]=P)}{const m=t[d];k(m!=null,`Previous layout not found for panel index ${d}`);const S=m-y,P=Y({panelConstraints:n,panelIndex:d,size:S});s[d]=P}return s}function ye(e,t,n,l){const a=l.getBoundingClientRect(),i=t==="horizontal",s=i?e.clientX:e.clientY,u=i?a.width:a.height;return(s-n)/u*100}function Se({panelDataArray:e}){const t=Array(e.length),n=[];let l=0;for(let a=0;a<e.length;a++){const i=e[a],{defaultSize:s}=i.constraints;s!=null?(t[a]=s,l+=s):n.push(a)}if(n.length>0){const a=100-l,i=Math.max(0,a/n.length);for(const s of n)t[s]=i}return t}function Pe({defaultSize:e,dragState:t,layout:n,panelData:l,panelIndex:a,precision:i=3}){const s=n[a];let u;return s==null?u=e!=null?e.toPrecision(i):"1":l.length===1?u="1":u=s.toPrecision(i),{flexBasis:0,flexGrow:u,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function ve(e,t,n){const l=parseInt(t.split("-").pop()||"0"),a=l,i=l+1;return[a,i]}function ae(e,t){const n=e==="horizontal";return"clientX"in t&&"clientY"in t?n?t.clientX:t.clientY:0}function xe({layout:e,panelConstraints:t}){const n=[...e];let l=0;for(let a=0;a<n.length;a++){const i=n[a],s=Y({panelConstraints:t,panelIndex:a,size:i});n[a]=s,l+=s}if(!M(l,100))for(let a=0;a<n.length;a++)n[a]=n[a]/l*100;return n}function oe(e,t,n){if(e.length!==t.length)return!1;for(let l=0;l<e.length;l++)if(!M(e[l],t[l],n))return!1;return!0}function q(e){if("clientX"in e&&"clientY"in e)return{x:e.clientX,y:e.clientY};if("touches"in e&&e.touches.length>0){const t=e.touches[0];return{x:t.clientX,y:t.clientY}}return{x:0,y:0}}function Ee(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Ce(e,t,n=!1){const l=n?0:1;return!(e.right<t.left+l||e.left>t.right-l||e.bottom<t.top+l||e.top>t.bottom-l)}function be(e,t){if(e===t)return 0;if(e.contains(t))return-1;if(t.contains(e))return 1;const n=e.compareDocumentPosition(t);return n&Node.DOCUMENT_POSITION_FOLLOWING?-1:n&Node.DOCUMENT_POSITION_PRECEDING?1:0}const ie=1,re=2,se=4,ue=8,Ie=Ee()==="coarse";let E=[],H=!1,N=new Map,O=new Map;const G=new Set;function we(e,t,n,l,a){const{ownerDocument:i}=t,s={direction:n,element:t,hitAreaMargins:l,setResizeHandlerState:a},u=N.get(i)??0;return N.set(i,u+1),G.add(s),X(),function(){O.delete(e),G.delete(s);const y=N.get(i)??1;if(N.set(i,y-1),X(),y===1&&N.delete(i),E.includes(s)){const m=E.indexOf(s);m>=0&&E.splice(m,1),K(),a("up",!0,null)}}}function Re(e){const{target:t}=e,{x:n,y:l}=q(e);H=!0,j({target:t,x:n,y:l}),X(),E.length>0&&(T("down",e),e.preventDefault(),ce(t)||e.stopImmediatePropagation())}function V(e){const{x:t,y:n}=q(e);if(H&&e.buttons===0&&(H=!1,T("up",e)),!H){const{target:l}=e;j({target:l,x:t,y:n})}T("move",e),K(),E.length>0&&e.preventDefault()}function F(e){const{target:t}=e,{x:n,y:l}=q(e);O.clear(),H=!1,E.length>0&&(e.preventDefault(),ce(t)||e.stopImmediatePropagation()),T("up",e),j({target:t,x:n,y:l}),K(),X()}function ce(e){let t=e;for(;t;){if(t.hasAttribute("data-panel-resize-handle"))return!0;t=t.parentElement}return!1}function j({target:e,x:t,y:n}){E.splice(0);let l=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(l=e),G.forEach(a=>{const{element:i,hitAreaMargins:s}=a,u=i.getBoundingClientRect(),{bottom:d,left:y,right:m,top:S}=u,P=Ie?s.coarse:s.fine;if(t>=y-P&&t<=m+P&&n>=S-P&&n<=d+P){if(l!==null&&document.contains(l)&&i!==l&&!i.contains(l)&&!l.contains(i)&&be(l,i)>0){let C=l,D=!1;for(;C&&!C.contains(i);){if(Ce(C.getBoundingClientRect(),u,!0)){D=!0;break}C=C.parentElement}if(D)return}E.push(a)}})}function W(e,t){O.set(e,t)}function K(){let e=!1,t=!1;E.forEach(l=>{const{direction:a}=l;a==="horizontal"?e=!0:t=!0});let n=0;O.forEach(l=>{n|=l}),e&&t?Q("intersection",n):e?Q("horizontal",n):t?Q("vertical",n):Le()}let Z=new AbortController;function X(){Z.abort(),Z=new AbortController;const e={capture:!0,signal:Z.signal};G.size&&(H?(E.length>0&&N.forEach((t,n)=>{const{body:l}=n;t>0&&(l.addEventListener("contextmenu",F,e),l.addEventListener("pointerleave",V,e),l.addEventListener("pointermove",V,e))}),window.addEventListener("pointerup",F,e),window.addEventListener("pointercancel",F,e)):N.forEach((t,n)=>{const{body:l}=n;t>0&&(l.addEventListener("pointerdown",Re,e),l.addEventListener("pointermove",V,e))}))}function T(e,t){G.forEach(n=>{const{setResizeHandlerState:l}=n,a=E.includes(n);l(e,a,t)})}let J=null,B=-1,R=null;function De(e,t){if(t){const n=(t&ie)!==0,l=(t&re)!==0,a=(t&se)!==0,i=(t&ue)!==0;if(n)return a?"se-resize":i?"ne-resize":"e-resize";if(l)return a?"sw-resize":i?"nw-resize":"w-resize";if(a)return"s-resize";if(i)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Le(){R!==null&&(document.head.removeChild(R),J=null,R=null,B=-1)}function Q(e,t){var l,a;const n=De(e,t);J!==n&&(J=n,R===null&&(R=document.createElement("style"),document.head.appendChild(R)),B>=0&&((l=R.sheet)==null||l.removeRule(B)),B=((a=R.sheet)==null?void 0:a.insertRule(`*{cursor: ${n} !important;}`))??-1)}const de=o.defineComponent({__name:"PanelGroup",props:{id:{},direction:{},className:{default:""},style:{default:()=>({})},tagName:{default:"div"},keyboardResizeBy:{default:null},onLayout:{}},emits:["layout"],setup(e,{emit:t}){const n=e,l=t,a=U(n.id),i=o.ref(),s=o.ref(null),u=o.ref([]),d=o.ref([]),y=o.ref(0),m=o.computed(()=>({display:"flex",flexDirection:n.direction==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%",...n.style})),S=r=>{let f=!1;const c=i.value;return c&&window.getComputedStyle(c,null).getPropertyValue("direction")==="rtl"&&(f=!0),function(h){h.preventDefault();const b=i.value;if(!b)return;const{initialLayout:_}=s.value??{},pe=ve(a,r),ze=ae(n.direction,h),{initialCursorPosition:p}=s.value||{initialCursorPosition:ze};let x=ye({clientX:"clientX"in h?h.clientX:0,clientY:"clientY"in h?h.clientY:0},n.direction,p,b);const L=n.direction==="horizontal";L&&f&&(x=-x);const He=d.value.map(_e=>_e.constraints),$=he({delta:x,initialLayout:_??u.value,panelConstraints:He,pivotIndices:pe,prevLayout:u.value,trigger:P(h)?"keyboard":"mouse-or-touch"}),me=!oe(u.value,$);(I(h)||C(h))&&y.value!=x&&(y.value=x,!me&&x!==0?L?W(r,x<0?ie:re):W(r,x<0?se:ue):W(r,0)),me&&(u.value=$,n.onLayout&&n.onLayout($),l("layout",$))}};function P(r){return r.type==="keydown"}function I(r){return r.type.startsWith("pointer")}function C(r){return r.type.startsWith("mouse")}const D=(r,f)=>{if(!i.value)return;const c=i.value.querySelector(`[data-panel-resize-handle-id="${r}"]`);if(!c){console.error(`Drag handle element not found for id "${r}"`);return}const g=ae(n.direction,f);s.value={dragHandleId:r,dragHandleRect:c.getBoundingClientRect(),initialCursorPosition:g,initialLayout:[...u.value]}},w=()=>{s.value=null},z=o.reactive({collapsePanel:r=>{console.log("collapsePanel",r)},get direction(){return n.direction},get dragState(){return s.value},expandPanel:(r,f)=>{console.log("expandPanel",r,f)},getPanelSize:r=>{const f=d.value.findIndex(c=>c.id===r.id);return u.value[f]||0},getPanelStyle:(r,f)=>{const c=d.value.findIndex(g=>g.id===r.id);return Pe({defaultSize:f,dragState:s.value,layout:u.value,panelData:d.value,panelIndex:c})},groupId:a,isPanelCollapsed:r=>!1,isPanelExpanded:r=>!z.isPanelCollapsed(r),reevaluatePanelConstraints:(r,f)=>{console.log("reevaluatePanelConstraints",r,f)},registerPanel:r=>{d.value.push(r),d.value.sort((g,h)=>{const b=g.order,_=h.order;return b==null&&_==null?0:b==null?-1:_==null?1:b-_});const f=Se({panelDataArray:d.value}),c=xe({layout:f,panelConstraints:d.value.map(g=>g.constraints)});oe(u.value,c)||(u.value=c,n.onLayout&&n.onLayout(c),l("layout",c))},registerResizeHandle:S,resizePanel:(r,f)=>{const c=d.value.findIndex(g=>g.id===r.id);c!==-1&&(u.value[c]=f)},startDragging:D,stopDragging:w,unregisterPanel:r=>{const f=d.value.findIndex(c=>c.id===r.id);if(f!==-1){if(d.value.splice(f,1),u.value.splice(f,1),d.value.length>0){const c=u.value.reduce((g,h)=>g+h,0);if(c<100){const g=(100-c)/u.value.length;u.value=u.value.map(h=>h+g)}}n.onLayout&&n.onLayout(u.value),l("layout",u.value)}},get panelGroupElement(){return i.value||null}});return o.provide(A,z),(r,f)=>(o.openBlock(),o.createBlock(o.resolveDynamicComponent(r.tagName),{ref_key:"panelGroupElementRef",ref:i,class:o.normalizeClass(r.className),style:o.normalizeStyle(m.value),"data-panel-group":!0,"data-panel-group-direction":r.direction,"data-panel-group-id":o.unref(a)},{default:o.withCtx(()=>[o.renderSlot(r.$slots,"default")]),_:3},8,["class","style","data-panel-group-direction","data-panel-group-id"]))}}),fe=o.defineComponent({__name:"PanelResizeHandle",props:{id:{},className:{default:""},disabled:{type:Boolean,default:!1},style:{default:()=>({})},tabIndex:{default:0},tagName:{default:"div"},hitAreaMargins:{default:()=>({coarse:15,fine:5})}},emits:["blur","focus","dragging","pointerDown","pointerUp","click"],setup(e,{emit:t}){const n=e,l=t,a=o.inject(A);if(!a)throw new Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:i,groupId:s,startDragging:u,stopDragging:d}=a,y=o.ref(),m=U(n.id),S=o.ref("inactive"),P=o.ref(!1),I=o.ref(null),C=o.computed(()=>({touchAction:"none",userSelect:"none",...n.style})),D=()=>{P.value=!1,l("blur")},w=()=>{P.value=!0,l("focus")},z=(c,g,h)=>{if(!g){S.value="inactive";return}let b=!1;switch(c){case"down":{S.value="drag",b=!1,h&&u(m,h),l("dragging",!0),l("pointerDown");break}case"move":{b=!0,S.value!=="drag"&&(S.value="hover");break}case"up":{S.value="hover",d(),l("dragging",!1),l("pointerUp"),b||l("click");break}}},r=()=>{if(n.disabled||!y.value)return;const c=we(m,y.value,i,n.hitAreaMargins,z);I.value=c},f=()=>{I.value&&(I.value(),I.value=null)};return o.watch(()=>n.disabled,c=>{c?f():r()}),o.onMounted(()=>{r()}),o.onUnmounted(()=>{f()}),(c,g)=>(o.openBlock(),o.createBlock(o.resolveDynamicComponent(c.tagName),{ref_key:"elementRef",ref:y,class:o.normalizeClass(c.className),style:o.normalizeStyle(C.value),tabindex:c.disabled?void 0:c.tabIndex,"data-panel-resize-handle":!0,"data-panel-resize-handle-id":o.unref(m),"data-panel-resize-handle-enabled":!c.disabled||void 0,"data-panel-resize-handle-disabled":c.disabled||void 0,"data-panel-group-direction":o.unref(i),"data-panel-group-id":o.unref(s),"data-panel-resize-handle-state":S.value,role:"separator",onBlur:D,onFocus:w},{default:o.withCtx(()=>[o.renderSlot(c.$slots,"default")]),_:3},40,["class","style","tabindex","data-panel-resize-handle-id","data-panel-resize-handle-enabled","data-panel-resize-handle-disabled","data-panel-group-direction","data-panel-group-id","data-panel-resize-handle-state"]))}});function Ne(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const Me={Panel:ne,PanelGroup:de,PanelResizeHandle:fe};v.Panel=ne,v.PanelGroup=de,v.PanelResizeHandle=fe,v.areEqual=Ne,v.assert=k,v.default=Me,v.fuzzyCompareNumbers=le,v.fuzzyNumbersEqual=M,Object.defineProperties(v,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
