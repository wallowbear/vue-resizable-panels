(function(P,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(P=typeof globalThis<"u"?globalThis:P||self,o(P.VueResizablePanels={},P.Vue))})(this,function(P,o){"use strict";const w=Symbol("PanelGroupContext");let G=0;function N(l){return l||(G++,`vue-resizable-panels:${G}`)}const k=o.defineComponent({__name:"Panel",props:{id:{},className:{default:""},collapsedSize:{default:0},collapsible:{type:Boolean,default:!1},defaultSize:{},maxSize:{},minSize:{},onCollapse:{},onExpand:{},onResize:{},order:{},style:{},tagName:{default:"div"}},emits:["collapse","expand","resize"],setup(l,{expose:t,emit:n}){const i=l,a=o.inject(w);if(!a)throw new Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:c,expandPanel:s,getPanelSize:d,getPanelStyle:h,groupId:x,isPanelCollapsed:E,reevaluatePanelConstraints:f,registerPanel:u,resizePanel:S,unregisterPanel:g}=a,m=N(i.id),e=o.ref({callbacks:{onCollapse:()=>n("collapse"),onExpand:()=>n("expand"),onResize:(z,B)=>n("resize",z,B)},constraints:{collapsedSize:i.collapsedSize,collapsible:i.collapsible,defaultSize:i.defaultSize,maxSize:i.maxSize,minSize:i.minSize},id:m,idIsFromProps:i.id!==void 0,order:i.order}),r=o.computed(()=>{const z=d(e.value);return console.log(`Panel ${m} size:`,z),z}),p=o.computed(()=>E(e.value)),v=o.computed(()=>{const z=h(e.value,i.defaultSize);return console.log(`Panel ${m} style:`,z),{...z,...i.style}});return o.watch(()=>({collapsedSize:i.collapsedSize,collapsible:i.collapsible,maxSize:i.maxSize,minSize:i.minSize}),(z,B)=>{const M={...e.value.constraints};e.value.constraints.collapsedSize=z.collapsedSize,e.value.constraints.collapsible=z.collapsible,e.value.constraints.maxSize=z.maxSize,e.value.constraints.minSize=z.minSize,(M.collapsedSize!==z.collapsedSize||M.collapsible!==z.collapsible||M.maxSize!==z.maxSize||M.minSize!==z.minSize)&&f(e.value,M)},{deep:!0}),o.onMounted(()=>{u(e.value)}),o.onUnmounted(()=>{g(e.value)}),t({collapse:()=>c(e.value),expand:z=>s(e.value,z),getId:()=>m,getSize:()=>d(e.value),isCollapsed:()=>p.value,isExpanded:()=>!E(e.value),resize:z=>S(e.value,z)}),(z,B)=>(o.openBlock(),o.createBlock(o.resolveDynamicComponent(z.tagName),{class:o.normalizeClass(z.className),style:o.normalizeStyle(v.value),"data-panel":!0,"data-panel-id":o.unref(m),"data-panel-size":r.value,"data-panel-collapsible":z.collapsible||void 0,"data-panel-collapsed":p.value||void 0},{default:o.withCtx(()=>[o.renderSlot(z.$slots,"default")]),_:3},8,["class","style","data-panel-id","data-panel-size","data-panel-collapsible","data-panel-collapsed"]))}});function I(l,t){if(!l)throw new Error(t||"Assertion failed")}const _=5;function L(l,t,n=_){const i=parseFloat(l.toFixed(n)),a=parseFloat(t.toFixed(n));return i<a?-1:i>a?1:0}function b(l,t,n=_){return L(l,t,n)===0}function $(l,t){if(l.length!==t.length)return!1;for(let n=0;n<l.length;n++)if(!b(l[n],t[n]))return!1;return!0}function U({panelConstraints:l,panelIndex:t,size:n}){const{collapsedSize:i=0,collapsible:a,maxSize:c=100,minSize:s=0}=l[t]??{};return a&&b(n,i)?i:n<s?s:n>c?c:n}function R({panelConstraints:l,panelIndex:t,size:n}){return U({panelConstraints:l,panelIndex:t,size:n})}function j({delta:l,initialLayout:t,panelConstraints:n,pivotIndices:i,prevLayout:a,trigger:c}){if(b(l,0))return t;const s=[...t],[d,h]=i;I(d!=null,"Invalid first pivot index"),I(h!=null,"Invalid second pivot index");let x=0;if(c==="keyboard"){{const f=l<0?h:d,u=n[f];I(u,`Panel constraints not found for index ${f}`);const{collapsedSize:S=0,collapsible:g,minSize:m=0}=u;if(g){const e=t[f];if(I(e!=null,`Previous layout not found for panel index ${f}`),b(e,S)){const r=m-e;L(r,Math.abs(l))>0&&(l=l<0?0-r:r)}}}{const f=l<0?d:h,u=n[f];I(u,`No panel constraints found for index ${f}`);const{collapsedSize:S=0,collapsible:g,minSize:m=0}=u;if(g){const e=t[f];if(I(e!=null,`Previous layout not found for panel index ${f}`),b(e,m)){const r=e-S;L(r,Math.abs(l))>0&&(l=l<0?0-r:r)}}}}{const f=l<0?1:-1;let u=l<0?h:d,S=0;for(;;){const m=t[u];I(m!=null,`Previous layout not found for panel index ${u}`);const r=R({panelConstraints:n,panelIndex:u,size:100})-m;if(S+=r,u+=f,u<0||u>=n.length)break}const g=Math.min(Math.abs(l),Math.abs(S));l=l<0?0-g:g}{let u=l<0?d:h;for(;u>=0&&u<n.length;){const S=Math.abs(l)-Math.abs(x),g=t[u];I(g!=null,`Previous layout not found for panel index ${u}`);const m=g-S,e=R({panelConstraints:n,panelIndex:u,size:m});if(!b(g,e)&&(x+=g-e,s[u]=e,x.toPrecision(3).localeCompare(Math.abs(l).toPrecision(3),void 0,{numeric:!0})>=0))break;l<0?u--:u++}}if($(a,s))return a;{const f=l<0?h:d,u=t[f];I(u!=null,`Previous layout not found for panel index ${f}`);const S=u+x,g=R({panelConstraints:n,panelIndex:f,size:S});if(s[f]=g,!b(g,S)){let m=S-g,r=l<0?h:d;for(;r>=0&&r<n.length;){const p=s[r];I(p!=null,`Previous layout not found for panel index ${r}`);const v=p+m,y=R({panelConstraints:n,panelIndex:r,size:v});if(b(p,y)||(m-=y-p,s[r]=y),b(m,0))break;l>0?r--:r++}}}const E=s.reduce((f,u)=>u+f,0);return b(E,100)?s:a}function X(l,t,n,i){const a=i.getBoundingClientRect(),c=t==="horizontal",s=c?l.clientX:l.clientY,d=c?a.width:a.height;return(s-n)/d*100}function Y({panelDataArray:l}){const t=Array(l.length),n=[];let i=0;for(let a=0;a<l.length;a++){const c=l[a],{defaultSize:s}=c.constraints;s!=null?(t[a]=s,i+=s):n.push(a)}if(n.length>0){const a=100-i,c=Math.max(0,a/n.length);for(const s of n)t[s]=c}return t}function T({defaultSize:l,dragState:t,layout:n,panelData:i,panelIndex:a,precision:c=3}){const s=n[a];let d;return s==null?d=l!=null?l.toPrecision(c):"1":i.length===1?d="1":d=s.toPrecision(c),{flexBasis:0,flexGrow:d,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function O(l,t,n){const i=parseInt(t.split("-").pop()||"0"),a=i,c=i+1;return[a,c]}function V(l,t){const n=l==="horizontal";return"clientX"in t&&"clientY"in t?n?t.clientX:t.clientY:0}function A({layout:l,panelConstraints:t}){const n=[...l];let i=0;for(let a=0;a<n.length;a++){const c=n[a],s=R({panelConstraints:t,panelIndex:a,size:c});n[a]=s,i+=s}if(!b(i,100))for(let a=0;a<n.length;a++)n[a]=n[a]/i*100;return n}const q=o.defineComponent({__name:"PanelGroup",props:{id:{},direction:{},className:{default:""},style:{default:()=>({})},tagName:{default:"div"},keyboardResizeBy:{default:null},onLayout:{}},emits:["layout"],setup(l,{emit:t}){const n=l,i=N(n.id),a=o.ref(),c=o.ref(null),s=o.ref([]),d=o.ref([]);o.ref(0);const h=o.computed(()=>({display:"flex",flexDirection:n.direction==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%",...n.style})),x=(e,r)=>{if(console.log("Starting drag for handle:",e),!a.value)return;const p=a.value.querySelector(`[data-panel-resize-handle-id="${e}"]`);if(!p){console.error(`Drag handle element not found for id "${e}"`);return}const v=V(n.direction,r);c.value={dragHandleId:e,dragHandleRect:p.getBoundingClientRect(),initialCursorPosition:v,initialLayout:[...s.value]},console.log("Drag state set:",c.value),u()},E=()=>{c.value=null},f=e=>{if(!c.value||!a.value)return;console.log("Mouse move during drag");const{initialCursorPosition:r,initialLayout:p,dragHandleId:v}=c.value,y=X({clientX:e.clientX,clientY:e.clientY},n.direction,r,a.value);console.log("Delta percentage:",y);const C=O(i,v,a.value);console.log("Pivot indices:",C);const D=j({delta:y,initialLayout:p,panelConstraints:d.value.map(H=>H.constraints),pivotIndices:C,prevLayout:s.value,trigger:"mouse-or-touch"});console.log("Next layout:",D),$(s.value,D)||(s.value=D,n.onLayout&&n.onLayout(D),t("layout",D))},u=()=>{console.log("🎯 Adding global event listeners"),document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),console.log("✅ Global event listeners added")},S=()=>{console.log("🧹 Removing global event listeners"),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),console.log("✅ Global event listeners removed")},g=()=>{console.log("🛑 Stopping drag and cleanup"),E(),S()},m=o.reactive({collapsePanel:e=>{console.log("collapsePanel",e)},get direction(){return n.direction},get dragState(){return c.value},expandPanel:(e,r)=>{console.log("expandPanel",e,r)},getPanelSize:e=>{const r=d.value.findIndex(p=>p.id===e.id);return s.value[r]||0},getPanelStyle:(e,r)=>{const p=d.value.findIndex(v=>v.id===e.id);return T({defaultSize:r,dragState:c.value,layout:s.value,panelData:d.value,panelIndex:p})},groupId:i,handleResizeDrag:(e,r)=>{if(!c.value){x(e,r);return}f(r)},isPanelCollapsed:e=>!1,isPanelExpanded:e=>!m.isPanelCollapsed(e),reevaluatePanelConstraints:(e,r)=>{console.log("reevaluatePanelConstraints",e,r)},registerPanel:e=>{d.value.push(e),d.value.sort((v,y)=>{const C=v.order,D=y.order;return C==null&&D==null?0:C==null?-1:D==null?1:C-D});const r=Y({panelDataArray:d.value}),p=A({layout:r,panelConstraints:d.value.map(v=>v.constraints)});$(s.value,p)||(s.value=p,n.onLayout&&n.onLayout(p),t("layout",p))},resizePanel:(e,r)=>{const p=d.value.findIndex(v=>v.id===e.id);p!==-1&&(s.value[p]=r)},startDragging:x,stopDragging:g,unregisterPanel:e=>{const r=d.value.findIndex(p=>p.id===e.id);if(r!==-1){if(d.value.splice(r,1),s.value.splice(r,1),d.value.length>0){const p=s.value.reduce((v,y)=>v+y,0);if(p<100){const v=(100-p)/s.value.length;s.value=s.value.map(y=>y+v)}}n.onLayout&&n.onLayout(s.value),t("layout",s.value)}},get panelGroupElement(){return a.value||null}});return o.provide(w,m),(e,r)=>(o.openBlock(),o.createBlock(o.resolveDynamicComponent(e.tagName),{ref_key:"panelGroupElementRef",ref:a,class:o.normalizeClass(e.className),style:o.normalizeStyle(h.value),"data-panel-group":!0,"data-panel-group-direction":e.direction,"data-panel-group-id":o.unref(i)},{default:o.withCtx(()=>[o.renderSlot(e.$slots,"default")]),_:3},8,["class","style","data-panel-group-direction","data-panel-group-id"]))}}),F=o.defineComponent({__name:"PanelResizeHandle",props:{id:{},className:{default:""},disabled:{type:Boolean,default:!1},style:{default:()=>({})},tabIndex:{default:0},tagName:{default:"div"}},emits:["blur","focus","dragging","pointerDown","pointerUp","click"],setup(l,{emit:t}){const n=l,i=o.inject(w);if(!i)throw new Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:a,groupId:c}=i,s=o.ref(),d=N(n.id),h=o.ref(!1),x=o.ref(!1),E=o.computed(()=>({touchAction:"none",userSelect:"none",cursor:a==="horizontal"?"col-resize":"row-resize",...n.style})),f=()=>{h.value=!1,t("blur")},u=()=>{h.value=!0,t("focus")},S=e=>{n.disabled||(console.log("🖱️ Mouse down on resize handle:",d),e.preventDefault(),x.value=!0,i.startDragging&&i.startDragging(d,e),document.addEventListener("mousemove",g,{passive:!1}),document.addEventListener("mouseup",m,{passive:!1}),console.log("🎯 Started dragging, added global listeners"),t("pointerDown"),t("dragging",!0))},g=e=>{x.value&&(console.log("🖱️ Mouse move during drag"),e.preventDefault(),i.handleResizeDrag&&i.handleResizeDrag(d,e))},m=e=>{x.value&&(console.log("🖱️ Mouse up, ending drag"),e.preventDefault(),x.value=!1,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m),console.log("🧹 Ended dragging, removed global listeners"),t("pointerUp"),t("dragging",!1))};return o.onMounted(()=>{console.log("PanelResizeHandle mounted:",d)}),o.onUnmounted(()=>{x.value&&(document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m))}),(e,r)=>(o.openBlock(),o.createBlock(o.resolveDynamicComponent(e.tagName),{ref_key:"elementRef",ref:s,class:o.normalizeClass(e.className),style:o.normalizeStyle(E.value),tabindex:e.disabled?void 0:e.tabIndex,"data-panel-resize-handle":!0,"data-panel-resize-handle-id":o.unref(d),"data-panel-resize-handle-enabled":!e.disabled||void 0,"data-panel-resize-handle-disabled":e.disabled||void 0,"data-panel-group-direction":o.unref(a),"data-panel-group-id":o.unref(c),role:"separator",onBlur:f,onFocus:u,onMousedown:S},{default:o.withCtx(()=>[o.renderSlot(e.$slots,"default")]),_:3},40,["class","style","tabindex","data-panel-resize-handle-id","data-panel-resize-handle-enabled","data-panel-resize-handle-disabled","data-panel-group-direction","data-panel-group-id"]))}});function K(l,t){if(l.length!==t.length)return!1;for(let n=0;n<l.length;n++)if(l[n]!==t[n])return!1;return!0}const W={Panel:k,PanelGroup:q,PanelResizeHandle:F};P.Panel=k,P.PanelGroup=q,P.PanelResizeHandle=F,P.areEqual=K,P.assert=I,P.default=W,P.fuzzyCompareNumbers=L,P.fuzzyNumbersEqual=b,Object.defineProperties(P,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
