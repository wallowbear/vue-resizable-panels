(function(P,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(P=typeof globalThis<"u"?globalThis:P||self,t(P.VueResizablePanels={},P.Vue))})(this,function(P,t){"use strict";const N=Symbol("PanelGroupContext");let k=0;function $(l){return l||(k++,`vue-resizable-panels:${k}`)}const _=t.defineComponent({__name:"Panel",props:{id:{},className:{default:""},collapsedSize:{default:0},collapsible:{type:Boolean,default:!1},defaultSize:{},maxSize:{},minSize:{},onCollapse:{},onExpand:{},onResize:{},order:{},style:{},tagName:{default:"div"}},emits:["collapse","expand","resize"],setup(l,{expose:i,emit:n}){const a=l,o=n,u=t.inject(N);if(!u)throw new Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:s,expandPanel:r,getPanelSize:p,getPanelStyle:b,groupId:D,isPanelCollapsed:f,reevaluatePanelConstraints:d,registerPanel:x,resizePanel:S,unregisterPanel:v}=u,g=$(a.id),e=t.ref({callbacks:{onCollapse:()=>o("collapse"),onExpand:()=>o("expand"),onResize:(z,G)=>o("resize",z,G)},constraints:{collapsedSize:a.collapsedSize,collapsible:a.collapsible,defaultSize:a.defaultSize,maxSize:a.maxSize,minSize:a.minSize},id:g,idIsFromProps:a.id!==void 0,order:a.order}),c=t.computed(()=>{const z=p(e.value);return console.log(`Panel ${g} size:`,z),z}),m=t.computed(()=>f(e.value)),h=t.computed(()=>{const z=b(e.value,a.defaultSize);return console.log(`Panel ${g} style:`,z),{...z,...a.style}});return t.watch(()=>({collapsedSize:a.collapsedSize,collapsible:a.collapsible,maxSize:a.maxSize,minSize:a.minSize}),(z,G)=>{const L={...e.value.constraints};e.value.constraints.collapsedSize=z.collapsedSize,e.value.constraints.collapsible=z.collapsible,e.value.constraints.maxSize=z.maxSize,e.value.constraints.minSize=z.minSize,(L.collapsedSize!==z.collapsedSize||L.collapsible!==z.collapsible||L.maxSize!==z.maxSize||L.minSize!==z.minSize)&&d(e.value,L)},{deep:!0}),t.onMounted(()=>{x(e.value)}),t.onUnmounted(()=>{v(e.value)}),i({collapse:()=>s(e.value),expand:z=>r(e.value,z),getId:()=>g,getSize:()=>p(e.value),isCollapsed:()=>m.value,isExpanded:()=>!f(e.value),resize:z=>S(e.value,z)}),(z,G)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(z.tagName),{class:t.normalizeClass(z.className),style:t.normalizeStyle(h.value),"data-panel":!0,"data-panel-id":t.unref(g),"data-panel-size":c.value,"data-panel-collapsible":z.collapsible||void 0,"data-panel-collapsed":m.value||void 0},{default:t.withCtx(()=>[t.renderSlot(z.$slots,"default")]),_:3},8,["class","style","data-panel-id","data-panel-size","data-panel-collapsible","data-panel-collapsed"]))}});function I(l,i){if(!l)throw new Error(i||"Assertion failed")}const q=5;function w(l,i,n=q){const a=parseFloat(l.toFixed(n)),o=parseFloat(i.toFixed(n));return a<o?-1:a>o?1:0}function y(l,i,n=q){return w(l,i,n)===0}function B(l,i){if(l.length!==i.length)return!1;for(let n=0;n<l.length;n++)if(!y(l[n],i[n]))return!1;return!0}function j({panelConstraints:l,panelIndex:i,size:n}){const{collapsedSize:a=0,collapsible:o,maxSize:u=100,minSize:s=0}=l[i]??{};return o&&y(n,a)?a:n<s?s:n>u?u:n}function M({panelConstraints:l,panelIndex:i,size:n}){return j({panelConstraints:l,panelIndex:i,size:n})}function X({delta:l,initialLayout:i,panelConstraints:n,pivotIndices:a,prevLayout:o,trigger:u}){if(y(l,0))return i;const s=[...i],[r,p]=a;I(r!=null,"Invalid first pivot index"),I(p!=null,"Invalid second pivot index");let b=0;if(u==="keyboard"){{const f=l<0?p:r,d=n[f];I(d,`Panel constraints not found for index ${f}`);const{collapsedSize:x=0,collapsible:S,minSize:v=0}=d;if(S){const g=i[f];if(I(g!=null,`Previous layout not found for panel index ${f}`),y(g,x)){const e=v-g;w(e,Math.abs(l))>0&&(l=l<0?0-e:e)}}}{const f=l<0?r:p,d=n[f];I(d,`No panel constraints found for index ${f}`);const{collapsedSize:x=0,collapsible:S,minSize:v=0}=d;if(S){const g=i[f];if(I(g!=null,`Previous layout not found for panel index ${f}`),y(g,v)){const e=g-x;w(e,Math.abs(l))>0&&(l=l<0?0-e:e)}}}}{const f=l<0?1:-1;let d=l<0?p:r,x=0;for(;;){const v=i[d];I(v!=null,`Previous layout not found for panel index ${d}`);const e=M({panelConstraints:n,panelIndex:d,size:100})-v;if(x+=e,d+=f,d<0||d>=n.length)break}const S=Math.min(Math.abs(l),Math.abs(x));l=l<0?0-S:S}{let d=l<0?r:p;for(;d>=0&&d<n.length;){const x=Math.abs(l)-Math.abs(b),S=i[d];I(S!=null,`Previous layout not found for panel index ${d}`);const v=S-x,g=M({panelConstraints:n,panelIndex:d,size:v});if(!y(S,g)&&(b+=S-g,s[d]=g,b.toPrecision(3).localeCompare(Math.abs(l).toPrecision(3),void 0,{numeric:!0})>=0))break;l<0?d--:d++}}if(B(o,s))return o;{const f=l<0?p:r,d=i[f];I(d!=null,`Previous layout not found for panel index ${f}`);const x=d+b,S=M({panelConstraints:n,panelIndex:f,size:x});if(s[f]=S,!y(S,x)){let v=x-S,e=l<0?p:r;for(;e>=0&&e<n.length;){const c=s[e];I(c!=null,`Previous layout not found for panel index ${e}`);const m=c+v,h=M({panelConstraints:n,panelIndex:e,size:m});if(y(c,h)||(v-=h-c,s[e]=h),y(v,0))break;l>0?e--:e++}}}const D=s.reduce((f,d)=>d+f,0);return y(D,100)?s:o}function Y(l,i,n,a){const o=a.getBoundingClientRect(),u=i==="horizontal",s=u?l.clientX:l.clientY,r=u?o.width:o.height;return(s-n)/r*100}function T({panelDataArray:l}){const i=Array(l.length),n=[];let a=0;for(let o=0;o<l.length;o++){const u=l[o],{defaultSize:s}=u.constraints;s!=null?(i[o]=s,a+=s):n.push(o)}if(n.length>0){const o=100-a,u=Math.max(0,o/n.length);for(const s of n)i[s]=u}return i}function O({defaultSize:l,dragState:i,layout:n,panelData:a,panelIndex:o,precision:u=3}){const s=n[o];let r;return s==null?r=l!=null?l.toPrecision(u):"1":a.length===1?r="1":r=s.toPrecision(u),{flexBasis:0,flexGrow:r,flexShrink:1,overflow:"hidden",pointerEvents:i!==null?"none":void 0}}function V(l,i,n){const a=parseInt(i.split("-").pop()||"0"),o=a,u=a+1;return[o,u]}function A(l,i){const n=l==="horizontal";return"clientX"in i&&"clientY"in i?n?i.clientX:i.clientY:0}function K({layout:l,panelConstraints:i}){const n=[...l];let a=0;for(let o=0;o<n.length;o++){const u=n[o],s=M({panelConstraints:i,panelIndex:o,size:u});n[o]=s,a+=s}if(!y(a,100))for(let o=0;o<n.length;o++)n[o]=n[o]/a*100;return n}const F=t.defineComponent({__name:"PanelGroup",props:{id:{},direction:{},className:{default:""},style:{default:()=>({})},tagName:{default:"div"},keyboardResizeBy:{default:null},onLayout:{}},emits:["layout"],setup(l,{emit:i}){const n=l,a=i,o=$(n.id),u=t.ref(),s=t.ref(null),r=t.ref([]),p=t.ref([]);t.ref(0);const b=t.computed(()=>({display:"flex",flexDirection:n.direction==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%",...n.style})),D=(e,c)=>{if(console.log("Starting drag for handle:",e),!u.value)return;const m=u.value.querySelector(`[data-panel-resize-handle-id="${e}"]`);if(!m){console.error(`Drag handle element not found for id "${e}"`);return}const h=A(n.direction,c);s.value={dragHandleId:e,dragHandleRect:m.getBoundingClientRect(),initialCursorPosition:h,initialLayout:[...r.value]},console.log("Drag state set:",s.value),x()},f=()=>{s.value=null},d=e=>{if(!s.value||!u.value)return;console.log("Mouse move during drag");const{initialCursorPosition:c,initialLayout:m,dragHandleId:h}=s.value,C=Y({clientX:e.clientX,clientY:e.clientY},n.direction,c,u.value);console.log("Delta percentage:",C);const R=V(o,h,u.value);console.log("Pivot indices:",R);const E=X({delta:C,initialLayout:m,panelConstraints:p.value.map(U=>U.constraints),pivotIndices:R,prevLayout:r.value,trigger:"mouse-or-touch"});console.log("Next layout:",E),B(r.value,E)||(r.value=E,n.onLayout&&n.onLayout(E),a("layout",E))},x=()=>{console.log("🎯 Adding global event listeners"),document.addEventListener("mousemove",d),document.addEventListener("mouseup",v),console.log("✅ Global event listeners added")},S=()=>{console.log("🧹 Removing global event listeners"),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",v),console.log("✅ Global event listeners removed")},v=()=>{console.log("🛑 Stopping drag and cleanup"),f(),S()},g=t.reactive({collapsePanel:e=>{console.log("collapsePanel",e)},get direction(){return n.direction},get dragState(){return s.value},expandPanel:(e,c)=>{console.log("expandPanel",e,c)},getPanelSize:e=>{const c=p.value.findIndex(m=>m.id===e.id);return r.value[c]||0},getPanelStyle:(e,c)=>{const m=p.value.findIndex(h=>h.id===e.id);return O({defaultSize:c,dragState:s.value,layout:r.value,panelData:p.value,panelIndex:m})},groupId:o,handleResizeDrag:(e,c)=>{if(!s.value){D(e,c);return}d(c)},isPanelCollapsed:e=>!1,isPanelExpanded:e=>!g.isPanelCollapsed(e),reevaluatePanelConstraints:(e,c)=>{console.log("reevaluatePanelConstraints",e,c)},registerPanel:e=>{p.value.push(e),p.value.sort((h,C)=>{const R=h.order,E=C.order;return R==null&&E==null?0:R==null?-1:E==null?1:R-E});const c=T({panelDataArray:p.value}),m=K({layout:c,panelConstraints:p.value.map(h=>h.constraints)});B(r.value,m)||(r.value=m,n.onLayout&&n.onLayout(m),a("layout",m))},resizePanel:(e,c)=>{const m=p.value.findIndex(h=>h.id===e.id);m!==-1&&(r.value[m]=c)},startDragging:D,stopDragging:v,unregisterPanel:e=>{const c=p.value.findIndex(m=>m.id===e.id);if(c!==-1){if(p.value.splice(c,1),r.value.splice(c,1),p.value.length>0){const m=r.value.reduce((h,C)=>h+C,0);if(m<100){const h=(100-m)/r.value.length;r.value=r.value.map(C=>C+h)}}n.onLayout&&n.onLayout(r.value),a("layout",r.value)}},get panelGroupElement(){return u.value||null}});return t.provide(N,g),(e,c)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tagName),{ref_key:"panelGroupElementRef",ref:u,class:t.normalizeClass(e.className),style:t.normalizeStyle(b.value),"data-panel-group":!0,"data-panel-group-direction":e.direction,"data-panel-group-id":t.unref(o)},{default:t.withCtx(()=>[t.renderSlot(e.$slots,"default")]),_:3},8,["class","style","data-panel-group-direction","data-panel-group-id"]))}}),H=t.defineComponent({__name:"PanelResizeHandle",props:{id:{},className:{default:""},disabled:{type:Boolean,default:!1},style:{default:()=>({})},tabIndex:{default:0},tagName:{default:"div"}},emits:["blur","focus","dragging","pointerDown","pointerUp","click"],setup(l,{emit:i}){const n=l,a=i,o=t.inject(N);if(!o)throw new Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:u,groupId:s}=o,r=t.ref(),p=$(n.id),b=t.ref(!1),D=t.ref(!1),f=t.computed(()=>({touchAction:"none",userSelect:"none",cursor:u==="horizontal"?"col-resize":"row-resize",...n.style})),d=()=>{b.value=!1,a("blur")},x=()=>{b.value=!0,a("focus")},S=e=>{n.disabled||(console.log("🖱️ Mouse down on resize handle:",p),e.preventDefault(),D.value=!0,o.startDragging&&o.startDragging(p,e),document.addEventListener("mousemove",v,{passive:!1}),document.addEventListener("mouseup",g,{passive:!1}),console.log("🎯 Started dragging, added global listeners"),a("pointerDown"),a("dragging",!0))},v=e=>{D.value&&(console.log("🖱️ Mouse move during drag"),e.preventDefault(),o.handleResizeDrag&&o.handleResizeDrag(p,e))},g=e=>{D.value&&(console.log("🖱️ Mouse up, ending drag"),e.preventDefault(),D.value=!1,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",g),console.log("🧹 Ended dragging, removed global listeners"),a("pointerUp"),a("dragging",!1))};return t.onMounted(()=>{console.log("PanelResizeHandle mounted:",p)}),t.onUnmounted(()=>{D.value&&(document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",g))}),(e,c)=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(e.tagName),{ref_key:"elementRef",ref:r,class:t.normalizeClass(e.className),style:t.normalizeStyle(f.value),tabindex:e.disabled?void 0:e.tabIndex,"data-panel-resize-handle":!0,"data-panel-resize-handle-id":t.unref(p),"data-panel-resize-handle-enabled":!e.disabled||void 0,"data-panel-resize-handle-disabled":e.disabled||void 0,"data-panel-group-direction":t.unref(u),"data-panel-group-id":t.unref(s),role:"separator",onBlur:d,onFocus:x,onMousedown:S},{default:t.withCtx(()=>[t.renderSlot(e.$slots,"default")]),_:3},40,["class","style","tabindex","data-panel-resize-handle-id","data-panel-resize-handle-enabled","data-panel-resize-handle-disabled","data-panel-group-direction","data-panel-group-id"]))}});function W(l,i){if(l.length!==i.length)return!1;for(let n=0;n<l.length;n++)if(l[n]!==i[n])return!1;return!0}const J={Panel:_,PanelGroup:F,PanelResizeHandle:H};P.Panel=_,P.PanelGroup=F,P.PanelResizeHandle=H,P.areEqual=W,P.assert=I,P.default=J,P.fuzzyCompareNumbers=w,P.fuzzyNumbersEqual=y,Object.defineProperties(P,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
